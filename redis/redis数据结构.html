<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2022年Redis最新面试题 - Redis数据结构 | 漫步coding</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="漫步coding的博客">
    
    <link rel="preload" href="/project/assets/css/0.styles.2a1e5e66.css" as="style"><link rel="preload" href="/project/assets/js/app.34004228.js" as="script"><link rel="preload" href="/project/assets/js/2.eeb24f79.js" as="script"><link rel="preload" href="/project/assets/js/55.fdc8fcc9.js" as="script"><link rel="prefetch" href="/project/assets/js/10.c2b9e207.js"><link rel="prefetch" href="/project/assets/js/11.a59b52a4.js"><link rel="prefetch" href="/project/assets/js/12.f74f8d2f.js"><link rel="prefetch" href="/project/assets/js/13.1cdc54f3.js"><link rel="prefetch" href="/project/assets/js/14.54466736.js"><link rel="prefetch" href="/project/assets/js/15.03163b85.js"><link rel="prefetch" href="/project/assets/js/16.932067a4.js"><link rel="prefetch" href="/project/assets/js/17.ba11dbdc.js"><link rel="prefetch" href="/project/assets/js/18.45216f93.js"><link rel="prefetch" href="/project/assets/js/19.f5fa6b10.js"><link rel="prefetch" href="/project/assets/js/20.6633ae84.js"><link rel="prefetch" href="/project/assets/js/21.4eb648f8.js"><link rel="prefetch" href="/project/assets/js/22.cc2b6b3b.js"><link rel="prefetch" href="/project/assets/js/23.362f3e68.js"><link rel="prefetch" href="/project/assets/js/24.d072fdb4.js"><link rel="prefetch" href="/project/assets/js/25.0a77d255.js"><link rel="prefetch" href="/project/assets/js/26.6e1e0f2a.js"><link rel="prefetch" href="/project/assets/js/27.f9aca207.js"><link rel="prefetch" href="/project/assets/js/28.e92a4d37.js"><link rel="prefetch" href="/project/assets/js/29.4e1dcaab.js"><link rel="prefetch" href="/project/assets/js/3.dc393602.js"><link rel="prefetch" href="/project/assets/js/30.f9d56e6a.js"><link rel="prefetch" href="/project/assets/js/31.fa904c4a.js"><link rel="prefetch" href="/project/assets/js/32.30400fc3.js"><link rel="prefetch" href="/project/assets/js/33.a1ef6a50.js"><link rel="prefetch" href="/project/assets/js/34.8fb009a7.js"><link rel="prefetch" href="/project/assets/js/35.2a6fda65.js"><link rel="prefetch" href="/project/assets/js/36.294749cf.js"><link rel="prefetch" href="/project/assets/js/37.20683a66.js"><link rel="prefetch" href="/project/assets/js/38.ea5cb3f9.js"><link rel="prefetch" href="/project/assets/js/39.ccdeead5.js"><link rel="prefetch" href="/project/assets/js/4.f876ad59.js"><link rel="prefetch" href="/project/assets/js/40.48a6a4cf.js"><link rel="prefetch" href="/project/assets/js/41.8ef2ff9f.js"><link rel="prefetch" href="/project/assets/js/42.ddbb9271.js"><link rel="prefetch" href="/project/assets/js/43.5eef4375.js"><link rel="prefetch" href="/project/assets/js/44.4a1ccf61.js"><link rel="prefetch" href="/project/assets/js/45.cac19bc8.js"><link rel="prefetch" href="/project/assets/js/46.c5fcc280.js"><link rel="prefetch" href="/project/assets/js/47.5c69ad7c.js"><link rel="prefetch" href="/project/assets/js/48.2f6563d7.js"><link rel="prefetch" href="/project/assets/js/49.a5d08db0.js"><link rel="prefetch" href="/project/assets/js/5.18c5236f.js"><link rel="prefetch" href="/project/assets/js/50.a19adac6.js"><link rel="prefetch" href="/project/assets/js/51.7f17d99c.js"><link rel="prefetch" href="/project/assets/js/52.735ae462.js"><link rel="prefetch" href="/project/assets/js/53.4fa31046.js"><link rel="prefetch" href="/project/assets/js/54.d9a61a57.js"><link rel="prefetch" href="/project/assets/js/56.1622f292.js"><link rel="prefetch" href="/project/assets/js/57.bb9be80d.js"><link rel="prefetch" href="/project/assets/js/58.e6e338fc.js"><link rel="prefetch" href="/project/assets/js/59.56a9e2c0.js"><link rel="prefetch" href="/project/assets/js/6.e86df8f9.js"><link rel="prefetch" href="/project/assets/js/60.68726952.js"><link rel="prefetch" href="/project/assets/js/61.926ef892.js"><link rel="prefetch" href="/project/assets/js/62.0d84d4c8.js"><link rel="prefetch" href="/project/assets/js/63.4a857a88.js"><link rel="prefetch" href="/project/assets/js/64.7348fd03.js"><link rel="prefetch" href="/project/assets/js/7.9ebead10.js"><link rel="prefetch" href="/project/assets/js/8.06f9a33b.js"><link rel="prefetch" href="/project/assets/js/9.882160f3.js">
    <link rel="stylesheet" href="/project/assets/css/0.styles.2a1e5e66.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/project/" class="home-link router-link-active"><!----> <span class="site-name">漫步coding</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/project/" aria-current="page" class="sidebar-link">首页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2022年MySQL最新面试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>2022年Redis最新面试题</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/project/redis/前言.html" class="sidebar-link">前言</a></li><li><a href="/project/redis/redis基础知识.html" class="sidebar-link">Redis基础知识</a></li><li><a href="/project/redis/redis数据结构.html" class="active sidebar-link">Redis数据结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/project/redis/redis事务.html" class="sidebar-link">Redis事务</a></li><li><a href="/project/redis/redis数据持久化.html" class="sidebar-link">Redis数据持久化</a></li><li><a href="/project/redis/redis集群.html" class="sidebar-link">Redis集群</a></li><li><a href="/project/redis/redis淘汰策略.html" class="sidebar-link">Redis淘汰策略</a></li><li><a href="/project/redis/redis分布式锁.html" class="sidebar-link">Redis分布式锁</a></li><li><a href="/project/redis/redis缓存问题.html" class="sidebar-link">Redis缓存问题</a></li><li><a href="/project/redis/redis运维和部署.html" class="sidebar-link">Redis运维和部署</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>LeetCode高频算法面试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>IDEA系列教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>公众号</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="数据结构"><a href="#数据结构" class="header-anchor">#</a> 数据结构</h3> <ul><li>Redis的数据类型有哪些?</li> <li>说说 Redis 哈希槽的概念？</li> <li>Hash如何实现O(1)的查询和设置速度, 以及扩容原理</li> <li>布隆过滤器</li></ul> <h4 id="redis的数据类型有哪些"><a href="#redis的数据类型有哪些" class="header-anchor">#</a> Redis的数据类型有哪些？</h4> <p>出现概率: ★★★★★</p> <p>这个在面试的过程出现的概率特别高了。</p> <p><font color="#FF000">Redis 支持五种常用的数据类型：string（ 字符串），hash（ 哈希）， list（ 列表）， set（ 集合） 及 zsetsorted set：有序集合)</font>。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/395d0a03-1f7d-4d6f-911d-7190600a3b10.png" alt=""></p> <p>redis 的基本数据结构对应的底层实现如下图所示：</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/6e26ec1d-8d45-4e35-9c6c-09033586309d.png" alt=""></p> <p>1)、Redis 的字符串是<font color="#FF000">动态字符串</font>，是可以修改的字符串，内部结构实现上类似于 Java 的 ArrayList，采用<font color="#FF000">预分配冗余空间</font>的方式来减少内存的频繁分配，如图所示：</p> <p>len 是当前字符串实际长度，capacity 是为字符串分配的可用空间，当字符串长度小于 1M 时，扩容都是加倍现有的空间，如果超过 1M，扩容时一次只会多扩 1M 的空间。字符串最大长度为 512M。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/5fce194c-eb39-41eb-9f48-474c38f0dc73.png" alt=""></p> <p>2)、hash</p> <p>Redis Hash通过<font color="#FF000">分桶的方式</font>解决 hash 冲突。它是无序字典。内部实现结构是同样的<font color="#FF000">数组 + 链表二维结构</font>。第一维 hash 的数组位置碰撞时，就会将碰撞的元素使用链表串接起来。第一维是数组，第二维是链表。数组中存储的是第二维链表的第一个元素的指针。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/3ef784a8-0ce9-42af-bb84-076b6fa09839.png" alt=""></p> <p>3)、list</p> <p>Redis 的列表相当于 Java 语言中的 LinkedList，注意<font color="#FF000">它是链表而不是数组</font>。这意味着 list 的插入和删除操作非常快，时间复杂度为 O(1)，但是<font color="#FF000">索引定位很慢</font>，时间复杂度为 O(n)。</p> <p>list的特点是:</p> <ul><li>有序</li> <li>可以重复</li> <li>右边进左边出或者左边进右边出，则列表可以充当队列</li> <li>左边进左边出或者右边进右边出，则列表可以充当栈</li></ul> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/7b545730-f7fc-4a81-a0a8-afc3758f196a.png" alt=""></p> <p>4)、set</p> <p><font color="#FF000">set和字典非常类似</font>，其内部实现就是上述的hashTable的特殊实现，与字典不同的地方有两点：</p> <ul><li>只关注key值，所有的value都是NULL。</li> <li>在新增数据时会进行去重。</li></ul> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/0215349d-fcc7-4eaf-a199-13f7ae225b33.png" alt=""></p> <p>5)、zsetsorted set</p> <p>zset是Redis非常有特色的数据结构，它是基于Set并提供排序的有序集合。其中最为重要的特点就是支持通过score的权重来指定权重。一些排行榜、延迟任务比如指定1小时后执行, 就是使用这个数据结构实现的。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/121dc53f-a84d-46a4-b06c-a86c8e8f8a65.png" alt=""></p> <p>6)、<strong>拓展篇</strong></p> <p>如果你说你还知道一些其他的几种数据结构比如: HyperLogLog、Geo、Pub/Sub、Redis Module，BloomFilter，RedisSearch，Redis-ML，面试官得眼睛就开始发亮了。</p> <p>Redis5.0带来了Stream类型。从字面上看是流类型，但其实从功能上看，应该是Redis对消息队列（MQ，Message Queue）的完善实现。用过Redis做消息队列的都了解，基于Reids的消息队列实现有很多种，例如：</p> <ul><li>PUB/SUB，订阅/发布模式</li> <li>基于List的 LPUSH+BRPOP 的实现</li> <li>基于Sorted-Set的实现</li></ul> <p>Redis Stream的结构如图所示，它有一个消息链表，将所有加入的消息都串起来，每个消息都有一个唯一的ID和对应的内容。消息是持久化的，Redis重启后，内容还在。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/48a57d0c-934b-4172-9783-3abb6a06b408.png" alt=""></p> <h4 id="hash如何实现o-1-的查询和设置速度-以及扩容原理"><a href="#hash如何实现o-1-的查询和设置速度-以及扩容原理" class="header-anchor">#</a> Hash如何实现O(1)的查询和设置速度, 以及扩容原理</h4> <p>出现概率: ★★★★★</p> <p><font color="#FF000">Redis Hash通过分桶的方式解决 hash 冲突。它是无序字典。内部实现结构是同样的数组 + 链表二维结构</font>。第一维 hash 的数组位置碰撞时，就会将碰撞的元素使用链表串接起来。第一维是数组，第二维是链表。数组中存储的是第二维链表的第一个元素的指针。</p> <p>因为是通过数组取模的方式, 可以实现O(1)的查询和设置速度。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/3ef784a8-0ce9-42af-bb84-076b6fa09839.png" alt=""></p> <p>不过如果概率多时, 链表长度过长时，查询时间复杂度会降低到O(n)。这个需要进行扩容了。</p> <p><font color="#FF000">大字典的扩容</font>是非常耗时间的，需要<font color="#FF000">重新申请新的数组</font>，正常情况下，当 hash 表中元素的个数等于第一维数组的长度时，就会开始扩容，扩容的新数组是原数组大小的 2 倍，然后将旧字典所有链表中的元素重新挂接到新的数组下面，这是一个 O(n)级别的操作，Redis 使用渐进式 rehash 扩容，分多次来慢慢的将旧数组中的键值对rehash到新数组的操作就称之为渐进式rehash。渐进式rehash可以避免了集中式rehash带来的庞大计算量，在渐进式rehash过程中，因为还可能会有新的键值对存进来，此时Redis的做法是新添加的键值对统一放入ht[1]中，这样就确保了ht[0]键值对的数量只会减少，当执行rehash操作时需要执行查询操作，此时会先查询ht[0]，查找不到结果再到ht[1]中查询。</p> <h4 id="说说-redis-哈希槽的概念"><a href="#说说-redis-哈希槽的概念" class="header-anchor">#</a> 说说 Redis 哈希槽的概念？</h4> <p>出现概率: ★★★</p> <p>Redis集群没有使用一致性hash,而是引入了哈希槽的概念，<font color="#FF000">Redis集群有16384个哈希槽</font>，每个key通过CRC16校验后对16384取模来决定放置哪个槽，集群的每个节点负责一部分hash槽。</p> <h4 id="布隆过滤器"><a href="#布隆过滤器" class="header-anchor">#</a> 布隆过滤器</h4> <p>出现概率: ★★★</p> <p>这个在面试中出现的概率, 主要看面试官的偏好, 不过如果问到，而且你能回答比较好的， 估计是一个比较好的加分项。</p> <p>布隆过滤器是 Redis 的高级功能，虽然这种结构的去重率并不完全精确，但和其他结构一样都有特定的应用场景，比如当处理<font color="#FF000">海量数据时</font>，就可以使用布隆过滤器实现去重。</p> <p>一些场景: 百度爬虫系统每天会面临海量的 URL 数据，我们希望它每次只爬取最新的页面，而对于没有更新过的页面则不爬取，因策爬虫系统必须对已经抓取过的 URL 去重，否则会严重影响执行效率。但是如果使用一个 set（集合）去装载这些 URL 地址，那么将造成资源空间的严重浪费。</p> <p>布隆过滤器（Bloom Filter）是一个高空间利用率的概率性数据结构，由二进制向量（即位数组）和一系列随机映射函数（即哈希函数）两部分组成。</p> <p>布隆过滤器使用exists()来判断某个元素是否存在于自身结构中。当布隆过滤器判定某个值存在时，其实这个值只是有可能存在；当它说某个值不存在时，那这个值肯定不存在，这个误判概率大约在 1% 左右。</p> <p><strong>Bloom Filter的原理</strong></p> <p>1)、工作流程-添加元素</p> <p>布隆过滤器主要由位数组和一系列 hash 函数构成，其中位数组的初始状态都为 0。</p> <p>下面对布隆过滤器工作流程做简单描述，如下图所示：</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/13eb793d-1a5a-4c03-9d36-9bdc2380829a.png" alt=""></p> <p>2)、工作流程-判定元素是否存在</p> <p>当我们需要判断一个元素是否存时，其流程如下：首先对给定元素再次执行哈希计算，得到与添加元素时相同的位数组位置，判断所得位置是否都为 1，如果其中有一个为 0，那么说明元素不存在，若都为 1，则说明元素有可能存在。</p> <p>3)、 为什么是可能“存在”</p> <p>您可能会问，为什么是有可能存在？其实原因很简单，那些被置为 1 的位置也可能是由于其他元素的操作而改变的。比如，元素1 和 元素2，这两个元素同时将一个位置变为了 1（图1所示）。在这种情况下，我们就不能判定“元素 1”一定存在，这是布隆过滤器存在误判的根本原因。</p> <p><strong>Bloom Filter的缺点</strong></p> <p>bloom filter<font color="#FF000">牺牲了判断的准确率、删除的便利性</font> ，才做到在时间和空间上的效率比较高，是因为</p> <p>1)、存在误判，可能要查到的元素并没有在容器中，但是hash之后得到的k个位置上值都是1。如果bloom filter中存储的是黑名单，那么可以通过建立一个白名单来存储可能会误判的元素。</p> <p>2)、删除数据。一个放入容器的元素映射到bit数组的k个位置上是1，删除的时候不能简单的直接置为0，可能会影响其他元素的判断。可以考虑Counting Bloom Filter</p> <p>也欢迎关注我的公众号: <code>漫步coding</code>。 一起交流, 在coding的世界里漫步, 回复: <font color="#FF000"><code>redis</code></font>, 免费获取最新Redis面试题(含答案)。</p> <p><img src="https://images.xiaozhuanlan.com/uploads/photo/2022/5cb0c91e-fd83-4a04-8df6-65fb602b3834.png" alt=""></p> <p>希望这篇文章可以帮助大家, 也希望大家都能找到的好工作。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/project/redis/redis基础知识.html" class="prev">
        Redis基础知识
      </a></span> <span class="next"><a href="/project/redis/redis事务.html">
        Redis事务
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/project/assets/js/app.34004228.js" defer></script><script src="/project/assets/js/2.eeb24f79.js" defer></script><script src="/project/assets/js/55.fdc8fcc9.js" defer></script>
  </body>
</html>
